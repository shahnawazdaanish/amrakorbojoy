!function(t){"use strict";t(document).on("ready",function(){var e,a=t("#image_gallery"),i=t("#wpex_gallery_images_container ul.wpex_gallery_images");jQuery(".add_wpex_gallery_images").on("click","a",function(l){t(this);var r=a.val();l.preventDefault(),e?e.open():((e=wp.media.frames.image_gallery_frame=wp.media({frame:"post",title:wpexGmb.title,button:{text:wpexGmb.button},library:{type:"image"},multiple:!0,filterable:"all"})).on("insert",function(){e.state().get("selection").map(function(t){(t=t.toJSON()).id&&(r=r?r+","+t.id:t.id,i.append('\t\t\t\t\t\t\t<li class="image" data-attachment_id="'+t.id+'">\t\t\t\t\t\t\t\t<div class="attachment-preview">\t\t\t\t\t\t\t\t\t<div class="thumbnail">\t\t\t\t\t\t\t\t\t\t<img src="'+t.url+'" />\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t   <a href="#" class="wpex-gmb-remove" title="'+wpexGmb.remove+'">&times;</a>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</li>'))}),a.val(r)}),e.open())}),i.sortable({items:"li.image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"wpex-metabox-sortable-placeholder",start:function(t,e){e.item.css("background-color","#f6f6f6")},stop:function(t,e){e.item.removeAttr("style")},update:function(e,i){var l="";t("#wpex_gallery_images_container ul li.image").css("cursor","default").each(function(){var t=jQuery(this).attr("data-attachment_id");l=l+t+","}),a.val(l)}}),t("#wpex_gallery_images_container").on("click","a.wpex-gmb-remove",function(){t(this).closest("li.image").remove();var e="";return t("#wpex_gallery_images_container ul li.image").css("cursor","default").each(function(){var t=jQuery(this).attr("data-attachment_id");e=e+t+","}),a.val(e),!1})})}(jQuery);